# 第一章 Ruby初探

## Ruby的运行方法

​	最常见的方法是使用ruby命令执行，其次是irb命令，以交互式命令行的方式来执行。对于小程序来说，使用irb命令会简单一点。

### Ruby命令的执行方法

首先，看看如下的代码，保存到helloruby.rb文件中。.rb是Ruby程序的后缀。

````ruby
print("Hello, Ruby.\n")
````

````shell
$ ruby helloruby.rb
Hello, Ruby.
````

### irb命令的执行方法

与ruy命令一样，irb命令在控制台执行，不过不需要指定程序文件。

````shell
$ irb
irb(main):001:0> print("Hello, Ruby.\n")
Hello, Ruby.		//这是输入的执行结果
=> nil
irb(main):002:0>
````



ps: nil是print方法的返回值。

在控制台写的程序可以马上在控制台中执行，对于小程序测试非常方便。但是，不适合大城县。

在控制台输入 `exit` 后，按回车键，或者同时按下`Ctrl + d`, 都可以终止irb命令。

## 程序解说

### 对象

"Hello, Ruby.\n"这部分称为String对象。字符串、数值、时间等各种数据，在Ruby中都是对象。

### 方法

print是一个方法。方法就是对象的行为。数值的加法或乘法运算、字符串的合并、某时刻一小时后或一天后的计算等操作，都是通过执行方法实现。

## 字符串

" "和' '都可以创建字符串对象。

## 方法调用

Ruby在调用方法时可以省略()。上述的代码中，print方法还可以这样写：

````ruby
print "Hello, Ruby.\n"
````

如果想连续输入多个字符串，可以用,分割字符串，程序会按顺序输入字符串。

````ruby
print "Hello, ", "Ruby", ".", "\n"
````

Ruby是从上到下的顺序执行方法的。执行下面的代码会得到相同的结果。

````ruby
print "Hello, "
print "Ruby"
print "."
print "\n"
````

## puts方法

`puts`方法与`print`方法稍有区别，puts方法在输出结果的末尾一定会输出换行符。

````ruby
puts "Hello, Ruby."
````

当参数为两个字符串时，会在每个字符串末尾加上换行符。

## p方法

无论使用 `print` 方法还是 `puts` 方法，输出数值 1 和字符串 `"1"` 时，结果都只是单纯的 1。这样一来，我们就无法判断输出的结果到底是属于哪个对象。这种情况下，`p` 方法可以很好地解决这个问题。使用 `p` 方法时，数值结果和字符串结果会以不同的形式输出。

````ruby
puts "100"		#=> 100
puts 100 			#=> 100
p "100"				#=> "100"
p 100					#=> 100
````

ps: `#=>` 字符右侧即为方法的输出结果

另外，使用 `p` 方法时，换行符（`\n`）、制表符（`\t`）等特殊字符不会转义，新建put_and_p.rb文件。

````ruby
puts "Hello, \n\tRuby."
p "Hello, \n\tRuby."
````

````shell
$ ruby puts_and_p.rb
Hello,
          Ruby.
"Hello, \n\tRuby."
````

如果只是需要输出程序执行的结果、信息等，可以选择 `print` 方法；如果想确认程序的执行情况，则可选择 `p` 方法。原则上，`p` 方法是提供给编程者使用的。

Ruby 程序的编码方式，是通过在程序的首行代码添加注释“`# encoding: 编码方式`”来指定的（编码的规则称为 encoding）.称这个注释为魔法注释（magic comment）。

| 平台     | 编码方式           |
| :------- | :----------------- |
| Windows  | GBK（或者GB 2312） |
| Mac OS X | UTF-8              |
| Unix     | UTF-8              |

从 Ruby 2.0 开始，若没指定魔法注释，Ruby 会默认使用 UTF-8 编码方式。因此，在 Ruby 2.0 中如果希望代码采用 UTF-8 的编码方式时，可省略魔法注释 。

## 数值表示与计算

在 Ruby 程序里，整数和小数（浮点数）的处理方式都很自然。

### 数值

1表示整数，3.1415表示浮点数

### 四则运算

同其他语言

### 数学的相关函数

除四则运算外，Ruby 中还可以使用数学函数，如平方根、sin 和 cos 等三角函数、指数函数等。使用数学函数时，必须在函数前加上 `Math.` 标识。

## 变量

变量是程序里不可缺少的元素之一。可以将其理解为给对象贴上的标签。

我们可以像下面这样给对象贴上标签（如图）：

**变量名 = 对象**

我们称这个过程为“将对象赋值给变量”。

![](https://box.kancloud.cn/2015-10-26_562e01d58b775.png)

在字符串里使用 `#{...}` 这样的写法，可以把变量的值嵌入到字符串中。

````ruby
name = "Ruby"
print "My Name is #{name}"
````

## 注释

单行注释：以`#`以后的部分都是注释。

多行注释：`=begin`和`=end`括起来的部分都是注释。

````ruby
=begin
《Ruby 基础教程（第 4 版）》示例
注释的使用示例
2006/06/16 创建
2006/07/01 追加一部分注释
2013/04/01 第 4 版更新
=end

# 这是单行注释
````

## 控制语句

### 控制语句的分类

	#### 顺序控制

顺序控制是程序最常见的处理方式。若不做特殊处理，程序会按照代码的编写顺序执行。

#### 条件控制

条件控制，是指根据条件执行分支处理。如果没有满足条件，程序会跳过某部分处理，继续执行其他处理。在 Ruby 中，可使用的条件判断语句有 `if`、`unless`、`case` 等。

##### 条件判断：if~then~end

`if` 语句用于根据条件变化，改变程序的行为。`if` 语句的语法如下所示：

**`if` 条件 `then`**

**`if` 条件 `then`
　条件成立时执行的处理
`en`**

条件一般是指能返回 `true` 或者 `false` 的表达式。

在比较数值的大小时，会用到等号、不等号等运算符。在 Ruby 中，`=` 已经被用作赋值运算了，因此判断是否相等的运算符要用两个并列等号`==` 来代替`=`。另外，`≤`和`≥`运算符在 Ruby 中分别用 `<=` 和 `>=` 来替代。

也可以使用`==`运算符比较字符串。字符串内容相同则返回 `true`，内容不同则返回 `false`。

新建bigger_smaller.rb文件，实现简单的程序：变量 a 大于等于 10 时输出 bigger，小于 9 时输出 smaller。

````ruby
a = 20
if a >= 10 then
  print "bigger\n"
end
  
if a <= 9 then
  print "smaller\n"
end
````

在这里可以省略 `then` 关键字。

````ruby
if a >= 10
  print "bigger\n"
end
````

如果希望对条件成立和条件不成立时采取不同的处理，我们可以使用 `else` 关键字。

**`if` 条件 `then`
　条件成立时执行的处理
`else`
　条件不成立时执行的处理
`end`**

使用 `else` 关键字改写刚才的程序后，会变成下面这样，

````ruby
if a >= 10
  print "bigger\n"
else
  print "smaller\n"
end
````

#### 循环控制

循环控制，是指根据条件反复执行某个处理。在这种情况下，该处理的执行顺序会与程序编写的顺序不同，执行过一次的程序，会从头再执行一次。

##### while语句

`while` 语句是执行循序时用到的一种基本语句。同样地，`do` 关键字可以省略。

**`while` 循环条件 `do`
　希望循环的处理
`end`**

````ruby
i = 1
while i <= 10
  print i, "\n"
  i = i + 1
end
````

##### times方法

循环处理的循环次数如果已确定，使用 `times` 方法会更加简单。

**循环次数 .`times do`
　希望循环的处理
`end`**

````ruby
100.times do 
  print "All work and no play makes Jack a dull boy.\n"
end
````

`times` 方法被称为迭代器（iterator）。迭代器是 Ruby 的一个特色功能。迭代器表示的是循环（iterate）的容器（-or）。类似地，运算符（operator）也就是运算（operate）的容器（-or），等等。总之，迭代器就是指用于执行循环处理的方法。

#### 异常控制

异常控制有点特殊。程序执行时，意料之外的错误发生后，就会跳出正在执行的那部分程序，然后执行其他地方的程序，使程序能继续执行下去。根据实际情况，有时也会让程序马上结束。



# 第2章 便利的对象



# Reference
https://www.kancloud.cn/imxieke/ruby-base/107282